{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport * as THREE from 'three';\n\nvar perfectChart = function () {\n  function perfectChart(container) {\n    _classCallCheck(this, perfectChart);\n\n    this.config = null;\n    this.data = null;\n    this.slice = null;\n    this.limit = null;\n    this.scene = null;\n    this.camera = null;\n    this.renderer = null;\n    this.cubeFrame = null;\n    this.axesHelper = null;\n    this.container = container;\n  }\n\n  _createClass(perfectChart, [{\n    key: \"setConfig\",\n    value: function setConfig(config) {\n      this.config = config;\n    }\n  }, {\n    key: \"reCalculationLimit\",\n    value: function reCalculationLimit(slice) {\n      this.slice = slice;\n      var vOrigin = this.slice.origin;\n      var vDes = this.slice.destination;\n      !vOrigin && (vOrigin = {\n        x: 0,\n        y: 0,\n        z: 0\n      });\n      var sz = this.config.size,\n          x = sz.x,\n          y = sz.y,\n          z = sz.z;\n      !vDes && (vDes = {\n        x: x,\n        y: y,\n        z: z\n      });\n\n      var max = function max(a, b) {\n        return a > b ? a : b;\n      };\n\n      var min = function min(a, b) {\n        return a < b ? a : b;\n      };\n\n      this.limit = {\n        ix: x,\n        iy: y,\n        iz: z,\n        idx: Math.abs(vOrigin.x - vDes.x),\n        idy: Math.abs(vOrigin.y - vDes.y),\n        idz: Math.abs(vOrigin.z - vDes.z),\n        ix0: min(vOrigin.x, vDes.x),\n        iy0: min(vOrigin.y, vDes.y),\n        iz0: min(vOrigin.z, vDes.z),\n        ix1: max(vOrigin.x, vDes.x) - 1,\n        iy1: max(vOrigin.y, vDes.y) - 1,\n        iz1: max(vOrigin.z, vDes.z) - 1\n      };\n    }\n  }, {\n    key: \"updateFaceAB\",\n    value: function updateFaceAB(isFront) {\n      var iCount = 0;\n      var size = this.limit;\n      var i1st0 = size.ix0;\n      var i1st1 = size.ix1;\n      var i2nd0 = size.iz0;\n      var i2nd1 = size.iz1;\n      var iOrder = isFront ? 0 : 1;\n      var iExtreme = size[\"iy\" + (isFront ? \"0\" : \"1\")];\n\n      for (var ii = i2nd0; ii <= i2nd1; ii++) {\n        for (var jj = i1st0; jj <= i1st1; jj++) {\n          this.setTileColor(iOrder, iCount, this.data.values[jj][iExtreme][ii]);\n          iCount++;\n        }\n      }\n\n      this.cubeFrame.children[iOrder].geometry.colorsNeedUpdate = true;\n    }\n  }, {\n    key: \"updateFaceCD\",\n    value: function updateFaceCD(isFront) {\n      var iCount = 0;\n      var size = this.limit;\n      var i1st0 = size.iy0;\n      var i1st1 = size.iy1;\n      var i2nd0 = size.iz0;\n      var i2nd1 = size.iz1;\n      var iOrder = isFront ? 2 : 3;\n      var iExtreme = size[\"ix\" + (isFront ? \"0\" : \"1\")];\n\n      for (var ii = i2nd0; ii <= i2nd1; ii++) {\n        for (var jj = i1st0; jj <= i1st1; jj++) {\n          this.setTileColor(iOrder, iCount, this.data.values[iExtreme][jj][ii]);\n          iCount++;\n        }\n      }\n\n      this.cubeFrame.children[iOrder].geometry.colorsNeedUpdate = true;\n    }\n  }, {\n    key: \"updateFaceEF\",\n    value: function updateFaceEF(isFront) {\n      var iCount = 0;\n      var size = this.limit;\n      var i1st0 = size.ix0;\n      var i1st1 = size.ix1;\n      var i2nd0 = size.iy0;\n      var i2nd1 = size.iy1;\n      var iOrder = isFront ? 4 : 5;\n      var iExtreme = size[\"iz\" + (isFront ? \"0\" : \"1\")];\n\n      for (var ii = i2nd0; ii <= i2nd1; ii++) {\n        for (var jj = i1st0; jj <= i1st1; jj++) {\n          this.setTileColor(iOrder, iCount, this.data.values[jj][ii][iExtreme]);\n          iCount++;\n        }\n      }\n\n      this.cubeFrame.children[iOrder].geometry.colorsNeedUpdate = true;\n    }\n  }, {\n    key: \"setTileColor\",\n    value: function setTileColor(faceOrder, i, value) {\n      var iMin = this.data.min;\n      var hue = (240 - 240 * (value - iMin) / (this.data.max - iMin)) / 360;\n      var currFace = this.cubeFrame.children[faceOrder].geometry.faces;\n      currFace[2 * i].color.setHSL(hue, 1, .5);\n      currFace[2 * i + 1].color.setHSL(hue, 1, .5);\n    }\n  }, {\n    key: \"initWorld\",\n    value: function initWorld() {\n      var e = new THREE.Scene();\n      e.background = new THREE.Color(15663086);\n      var t = new THREE.PerspectiveCamera(60, this.container.clientWidth / this.container.clientHeight, 1, 3e3);\n      t.up.set(0, 0, 1);\n      t.position.set(350, 350, 350);\n      var renderer = new THREE.WebGLRenderer();\n      renderer.setSize(this.container.clientWidth, this.container.clientHeight);\n      var n = new OrbitControls(t, renderer.domElement);\n      n.enableDamping = true;\n      n.dampingFactor = .05;\n      n.screenSpacePanning = false;\n      n.minDistance = 100;\n      n.maxDistance = 900;\n      n.maxPolarAngle = Math.PI;\n      n.rotateSpeed = .5;\n      var s = this.config.size;\n      var axesHelper = new THREE.AxesHelper(s.tilesize * (1.7 * Math.max(s.x, s.y, s.z)));\n      e.add(axesHelper);\n\n      var animate = function animate() {\n        requestAnimationFrame(animate);\n        n.update();\n        renderer.render(e, t);\n      };\n\n      animate();\n      this.scene = e;\n      this.camera = t;\n      this.controls = n;\n      this.renderer = renderer;\n      this.axesHelper = axesHelper;\n      this.container.appendChild(renderer.domElement);\n    }\n  }, {\n    key: \"makeDoor\",\n    value: function makeDoor() {\n      console.info(\"makeDoor\");\n      var e = this.config.door;\n\n      if (e.show && this.scene) {\n        var t = this.config.size,\n            i = {\n          x: t.x * t.tilesize,\n          y: t.y * t.tilesize,\n          z: t.z * t.tilesize,\n          e: 20 * t.tilesize\n        },\n            n = {\n          A: {\n            x0: i.x / 2,\n            y0: -i.e,\n            z0: i.z / 2,\n            x1: i.x / 2,\n            y1: i.y,\n            z1: i.z / 2\n          },\n          B: {\n            x0: i.x / 2,\n            y0: i.y + i.e,\n            z0: i.z / 2,\n            x1: i.x / 2,\n            y1: i.y,\n            z1: i.z / 2\n          },\n          C: {\n            x0: -i.e,\n            y0: i.y / 2,\n            z0: i.z / 2,\n            x1: i.x,\n            y1: i.y / 2,\n            z1: i.z / 2\n          },\n          D: {\n            x0: i.x + i.e,\n            y0: i.y / 2,\n            z0: i.z / 2,\n            x1: i.x,\n            y1: i.y / 2,\n            z1: i.z / 2\n          }\n        }[e.direction],\n            s = new THREE.Vector3(n.x1 - n.x0, n.y1 - n.y0, n.z1 - n.z0),\n            a = new THREE.Vector3(n.x0, n.y0, n.z0),\n            r = 8 * t.tilesize,\n            o = 2 * t.tilesize,\n            c = 1 * t.tilesize,\n            l = new THREE.ArrowHelper(s.normalize(), a, r, 0xFFFFFF, o, c);\n        l.up.set(0, 0, 1);\n        this.scene.add(l);\n      }\n    }\n  }, {\n    key: \"makeWireFrame\",\n    value: function makeWireFrame() {\n      var e = new THREE.LineBasicMaterial({\n        color: 0,\n        linewidth: 2\n      }),\n          t = this.config.size,\n          i = t.x * t.tilesize,\n          n = t.y * t.tilesize,\n          s = t.z * t.tilesize,\n          a = [];\n      a.push(new THREE.Vector3(0, 0, 0));\n      a.push(new THREE.Vector3(i, 0, 0));\n      a.push(new THREE.Vector3(i, n, 0));\n      a.push(new THREE.Vector3(0, n, 0));\n      a.push(new THREE.Vector3(0, 0, 0));\n      a.push(new THREE.Vector3(0, 0, s));\n      a.push(new THREE.Vector3(i, 0, s));\n      a.push(new THREE.Vector3(i, n, s));\n      a.push(new THREE.Vector3(0, n, s));\n      a.push(new THREE.Vector3(0, 0, s));\n      var r = new THREE.BufferGeometry().setFromPoints(a);\n      (a = []).push(new THREE.Vector3(i, 0, 0));\n      a.push(new THREE.Vector3(i, 0, s));\n      a.push(new THREE.Vector3(i, n, s));\n      a.push(new THREE.Vector3(i, n, 0));\n      a.push(new THREE.Vector3(0, n, 0));\n      a.push(new THREE.Vector3(0, n, s));\n      var o = new THREE.BufferGeometry().setFromPoints(a),\n          c = new THREE.Line(r, e);\n      this.scene.add(c);\n      var l = new THREE.Line(o, e);\n      this.scene.add(l);\n    }\n  }, {\n    key: \"writeNumber\",\n    value: function writeNumber() {\n      var e = this;\n      var t = this.config.size.tilesize;\n\n      var i = function i(_i, n, s, a) {\n        var r = function (e) {\n          var i = document.createElement(\"canvas\"),\n              n = i.getContext(\"2d\");\n          i.width = i.height = 2 * t;\n          n.font = \"Bold \" + 2 * t + \"px Roboto\";\n          n.fillStyle = \"#7F007F\";\n          n.textAlign = \"center\";\n          n.fillText(e, t, 1.74591293182 * t);\n          var s = new THREE.Texture(i);\n          s.needsUpdate = !0;\n          var a = new THREE.SpriteMaterial({\n            map: s\n          }),\n              r = new THREE.Sprite(a);\n          r.scale.set(i.width, i.width, i.width);\n          return r;\n        }(String(_i));\n\n        r.position.set((n - .5) * t, (s - .5) * t, (a - .5) * t);\n        e.scene.add(r);\n      };\n\n      var n = this.config[\"axis-labels\"];\n      n[\"axis-x\"].show && n[\"axis-x\"].list.forEach(function (e) {\n        return i(e, e, 0, 0);\n      });\n      n[\"axis-y\"].show && n[\"axis-y\"].list.forEach(function (e) {\n        return i(e, 0, e, 0);\n      });\n      n[\"axis-z\"].show && n[\"axis-z\"].list.forEach(function (e) {\n        return i(e, 0, 0, e);\n      });\n    }\n  }, {\n    key: \"makeFrame\",\n    value: function makeFrame() {\n      var t = _objectSpread(_objectSpread({}, this.limit), this.config.size);\n\n      t = _objectSpread(_objectSpread({}, t), {}, {\n        sx: t.idx * t.tilesize,\n        sy: t.idy * t.tilesize,\n        sz: t.idz * t.tilesize\n      });\n      t = _objectSpread(_objectSpread({}, t), {}, {\n        hsx: t.sx / 2,\n        hsy: t.sy / 2,\n        hsz: t.sz / 2\n      });\n\n      var i = [new THREE.Vector3(3 * Math.PI / 2, 0, 0), new THREE.Vector3(3 * Math.PI / 2, 3 * Math.PI / 2, 0), new THREE.Vector3(Math.PI, 0, 0)],\n          n = this.limit.ix0 * t.tilesize,\n          s = this.limit.iy0 * t.tilesize,\n          a = this.limit.iz0 * t.tilesize,\n          r = [new THREE.Vector3(t.hsx + n, 0 + s, t.hsz + a), new THREE.Vector3(t.hsx + n, t.sy + s, t.hsz + a), new THREE.Vector3(0 + n, t.hsy + s, t.hsz + a), new THREE.Vector3(t.sx + n, t.hsy + s, t.hsz + a), new THREE.Vector3(t.hsx + n, t.hsy + s, 0 + a), new THREE.Vector3(t.hsx + n, t.hsy + s, t.sz + a)],\n          o = function o(i, n, s, a) {\n        var r = i[0],\n            o = i[1],\n            c = new THREE.PlaneGeometry(t[\"s\" + r], t[\"s\" + o], t[\"id\" + r], t[\"id\" + o]),\n            l = new THREE.MeshBasicMaterial({\n          vertexColors: THREE.FaceColors,\n          side: a\n        });\n        var h = new THREE.Mesh(c, l);\n        h.position.copy(s);\n        h.rotation.setFromVector3(n);\n        return h;\n      };\n\n      var l = new THREE.Object3D();\n      l.add(o(\"xzy\", i[0], r[0], THREE.BackSide));\n      l.add(o(\"xzy\", i[0], r[1], THREE.FrontSide));\n      l.add(o(\"yzx\", i[1], r[2], THREE.FrontSide));\n      l.add(o(\"yzx\", i[1], r[3], THREE.BackSide));\n      l.add(o(\"xyz\", i[2], r[4], THREE.FrontSide));\n      l.add(o(\"xyz\", i[2], r[5], THREE.BackSide));\n      this.scene.remove(this.cubeFrame);\n      this.cubeFrame = l;\n      this.scene.add(l);\n      return l;\n    }\n  }, {\n    key: \"updateChart\",\n    value: function updateChart(data) {\n      this.data = data;\n      this.updateFaceAB(true);\n      this.updateFaceAB(false);\n      this.updateFaceCD(true);\n      this.updateFaceCD(false);\n      this.updateFaceEF(true);\n      this.updateFaceEF(false);\n    }\n  }]);\n\n  return perfectChart;\n}();\n\nexport default perfectChart;","map":{"version":3,"sources":["D:/GIT HUB/NCKH2020/KHAN/AndroidApp/src/screens/status/components/perfectChart.js"],"names":["THREE","perfectChart","container","config","data","slice","limit","scene","camera","renderer","cubeFrame","axesHelper","vOrigin","origin","vDes","destination","x","y","z","sz","size","max","a","b","min","ix","iy","iz","idx","Math","abs","idy","idz","ix0","iy0","iz0","ix1","iy1","iz1","isFront","iCount","i1st0","i1st1","i2nd0","i2nd1","iOrder","iExtreme","ii","jj","setTileColor","values","children","geometry","colorsNeedUpdate","faceOrder","i","value","iMin","hue","currFace","faces","color","setHSL","e","Scene","background","Color","t","PerspectiveCamera","clientWidth","clientHeight","up","set","position","WebGLRenderer","setSize","n","OrbitControls","domElement","enableDamping","dampingFactor","screenSpacePanning","minDistance","maxDistance","maxPolarAngle","PI","rotateSpeed","s","AxesHelper","tilesize","add","animate","requestAnimationFrame","update","render","controls","appendChild","console","info","door","show","A","x0","y0","z0","x1","y1","z1","B","C","D","direction","Vector3","r","o","c","l","ArrowHelper","normalize","LineBasicMaterial","linewidth","push","BufferGeometry","setFromPoints","Line","document","createElement","getContext","width","height","font","fillStyle","textAlign","fillText","Texture","needsUpdate","SpriteMaterial","map","Sprite","scale","String","list","forEach","sx","sy","hsx","hsy","hsz","PlaneGeometry","MeshBasicMaterial","vertexColors","FaceColors","side","h","Mesh","copy","rotation","setFromVector3","Object3D","BackSide","FrontSide","remove","updateFaceAB","updateFaceCD","updateFaceEF"],"mappings":"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","sourcesContent":["import * as THREE from 'three';\r\n//import { Renderer } from 'expo-three';\r\n//import OrbitControls from 'orbit-controls-es6';\r\n\r\nclass perfectChart {\r\n    constructor(container){\r\n        this.config = null;\r\n        this.data = null;\r\n        this.slice = null;\r\n        this.limit = null;\r\n        this.scene = null;\r\n        this.camera = null;\r\n        this.renderer = null;\r\n        this.cubeFrame = null;\r\n        this.axesHelper = null;\r\n        this.container = container;\r\n    }\r\n\r\n    setConfig(config){\r\n        this.config = config;\r\n    }\r\n    reCalculationLimit(slice){\r\n        this.slice = slice;\r\n        let vOrigin = this.slice.origin;\r\n        let vDes = this.slice.destination;\r\n        !vOrigin && (vOrigin = {\r\n            x: 0,\r\n            y: 0,\r\n            z: 0\r\n        });\r\n\r\n        let sz = this.config.size, x=sz.x, y=sz.y, z=sz.z;\r\n        !vDes && (vDes = {\r\n            x: x,\r\n            y: y,\r\n            z: z\r\n        });\r\n\r\n        const max = (a, b) => (a>b)?a:b;\r\n        const min = (a, b) => (a<b)?a:b;\r\n        this.limit = {\r\n            ix: x,\r\n            iy: y,\r\n            iz: z,\r\n            idx: Math.abs(vOrigin.x - vDes.x),\r\n            idy: Math.abs(vOrigin.y - vDes.y),\r\n            idz: Math.abs(vOrigin.z - vDes.z),\r\n            ix0: min(vOrigin.x, vDes.x),//origin\r\n            iy0: min(vOrigin.y, vDes.y),\r\n            iz0: min(vOrigin.z, vDes.z),\r\n            ix1: max(vOrigin.x, vDes.x)-1,//destination\r\n            iy1: max(vOrigin.y, vDes.y)-1,\r\n            iz1: max(vOrigin.z, vDes.z)-1\r\n        }\r\n    }\r\n    updateFaceAB(isFront) {\r\n        //xzy\r\n        let iCount = 0;\r\n        let size = this.limit;//t = this.limit\r\n        let i1st0 = size.ix0;\r\n        let i1st1 = size.ix1;\r\n        let i2nd0 = size.iz0;\r\n        let i2nd1 = size.iz1;\r\n        let iOrder = (isFront)?0:1;\r\n        let iExtreme = size[\"iy\" + (isFront ? \"0\" : \"1\")];\r\n        for (let ii=i2nd0 ; ii <= i2nd1; ii++)\r\n            for (let jj=i1st0; jj <= i1st1; jj++){\r\n                this.setTileColor(iOrder, iCount, this.data.values[jj][iExtreme][ii]);\r\n                iCount++;\r\n            }\r\n        this.cubeFrame.children[iOrder].geometry.colorsNeedUpdate = true;\r\n    }\r\n    updateFaceCD(isFront) {\r\n        //yzx\r\n        let iCount = 0;\r\n        let size = this.limit;//t = this.limit\r\n        let i1st0 = size.iy0;\r\n        let i1st1 = size.iy1;\r\n        let i2nd0 = size.iz0;\r\n        let i2nd1 = size.iz1;\r\n        let iOrder = (isFront)?2:3;\r\n        let iExtreme = size[\"ix\" + (isFront ? \"0\" : \"1\")];\r\n        for (let ii=i2nd0 ; ii <= i2nd1; ii++)\r\n            for (let jj=i1st0; jj <= i1st1; jj++){\r\n                this.setTileColor(iOrder, iCount, this.data.values[iExtreme][jj][ii]);\r\n                iCount++;\r\n            }\r\n        this.cubeFrame.children[iOrder].geometry.colorsNeedUpdate = true;\r\n    }\r\n    updateFaceEF(isFront) {\r\n        //xyz\r\n        let iCount = 0;\r\n        let size = this.limit;//t = this.limit\r\n        let i1st0 = size.ix0;\r\n        let i1st1 = size.ix1;\r\n        let i2nd0 = size.iy0;\r\n        let i2nd1 = size.iy1;\r\n        let iOrder = (isFront)?4:5;\r\n        let iExtreme = size[\"iz\" + (isFront ? \"0\" : \"1\")];\r\n        for (let ii=i2nd0 ; ii <= i2nd1; ii++)\r\n            for (let jj=i1st0; jj <= i1st1; jj++){\r\n                this.setTileColor(iOrder, iCount, this.data.values[jj][ii][iExtreme]);\r\n                iCount++;\r\n            }\r\n        this.cubeFrame.children[iOrder].geometry.colorsNeedUpdate = true;\r\n    }\r\n    setTileColor(faceOrder, i, value){\r\n        let iMin = this.data.min;\r\n        let hue = (240 - 240 * (value - iMin) / (this.data.max - iMin)) / 360;\r\n        let currFace = this.cubeFrame.children[faceOrder].geometry.faces;\r\n        currFace[2 * i].color.setHSL(hue, 1, .5);\r\n        currFace[2 * i + 1].color.setHSL(hue, 1, .5);\r\n    }\r\n\r\n    initWorld(){\r\n        //console.info(\"makeWorld\");\r\n        let e = new THREE.Scene();\r\n        e.background = new THREE.Color(15663086);\r\n        let t = new THREE.PerspectiveCamera(60,this.container.clientWidth / this.container.clientHeight,1,3e3);\r\n        t.up.set(0, 0, 1);\r\n        t.position.set(350, 350, 350);\r\n        let renderer = new THREE.WebGLRenderer();\r\n        renderer.setSize(this.container.clientWidth, this.container.clientHeight);\r\n        let n = new OrbitControls(t, renderer.domElement);\r\n        n.enableDamping = true;\r\n        n.dampingFactor = .05;\r\n        n.screenSpacePanning = false;\r\n        n.minDistance = 100;\r\n        n.maxDistance = 900;\r\n        n.maxPolarAngle = Math.PI;\r\n        n.rotateSpeed = .5;\r\n\r\n        //make axesHelper\r\n        let s = this.config.size\r\n        let axesHelper = new THREE.AxesHelper(s.tilesize * (1.7 * Math.max(s.x, s.y, s.z)));\r\n        e.add(axesHelper);\r\n\r\n        let animate = function() {\r\n            requestAnimationFrame(animate);\r\n            n.update();\r\n            renderer.render(e, t);\r\n        };\r\n        animate();\r\n        this.scene = e;\r\n        this.camera = t;\r\n        this.controls = n;\r\n        this.renderer = renderer;\r\n        this.axesHelper = axesHelper;\r\n        this.container.appendChild( renderer.domElement);\r\n    }\r\n    makeDoor() {\r\n        console.info(\"makeDoor\");\r\n        let e = this.config.door;\r\n        if (e.show && this.scene) {\r\n            let t = this.config.size\r\n              , i = {\r\n                x: t.x * t.tilesize,\r\n                y: t.y * t.tilesize,\r\n                z: t.z * t.tilesize,\r\n                e: 20 * t.tilesize\r\n            }\r\n              , n = {\r\n                A: {\r\n                    x0: i.x / 2,\r\n                    y0: -i.e,\r\n                    z0: i.z / 2,\r\n                    x1: i.x / 2,\r\n                    y1: i.y,\r\n                    z1: i.z / 2\r\n                },\r\n                B: {\r\n                    x0: i.x / 2,\r\n                    y0: i.y + i.e,\r\n                    z0: i.z / 2,\r\n                    x1: i.x / 2,\r\n                    y1: i.y,\r\n                    z1: i.z / 2\r\n                },\r\n                C: {\r\n                    x0: -i.e,\r\n                    y0: i.y / 2,\r\n                    z0: i.z / 2,\r\n                    x1: i.x,\r\n                    y1: i.y / 2,\r\n                    z1: i.z / 2\r\n                },\r\n                D: {\r\n                    x0: i.x + i.e,\r\n                    y0: i.y / 2,\r\n                    z0: i.z / 2,\r\n                    x1: i.x,\r\n                    y1: i.y / 2,\r\n                    z1: i.z / 2\r\n                }\r\n            }[e.direction]\r\n              , s = new THREE.Vector3(n.x1 - n.x0,n.y1 - n.y0,n.z1 - n.z0)\r\n              , a = new THREE.Vector3(n.x0,n.y0,n.z0)\r\n              , r = 8 * t.tilesize\r\n              , o = 2 * t.tilesize\r\n              , c = 1 * t.tilesize\r\n              , l = new THREE.ArrowHelper(s.normalize(),a,r,0xFFFFFF,o,c);\r\n            l.up.set(0, 0, 1);\r\n            this.scene.add(l);\r\n        }\r\n    }\r\n    makeWireFrame() {\r\n        //console.info(\"makeWireFrame\");\r\n        let e = new THREE.LineBasicMaterial({\r\n            color: 0,\r\n            linewidth: 2\r\n        })\r\n          , t = this.config.size\r\n          , i = t.x * t.tilesize\r\n          , n = t.y * t.tilesize\r\n          , s = t.z * t.tilesize\r\n          , a = [];\r\n        a.push(new THREE.Vector3(0,0,0));\r\n        a.push(new THREE.Vector3(i,0,0));\r\n        a.push(new THREE.Vector3(i,n,0));\r\n        a.push(new THREE.Vector3(0,n,0));\r\n        a.push(new THREE.Vector3(0,0,0));\r\n        a.push(new THREE.Vector3(0,0,s));\r\n        a.push(new THREE.Vector3(i,0,s));\r\n        a.push(new THREE.Vector3(i,n,s));\r\n        a.push(new THREE.Vector3(0,n,s));\r\n        a.push(new THREE.Vector3(0,0,s));\r\n        let r = (new THREE.BufferGeometry()).setFromPoints(a);\r\n        (a = []).push(new THREE.Vector3(i,0,0));\r\n        a.push(new THREE.Vector3(i,0,s));\r\n        a.push(new THREE.Vector3(i,n,s));\r\n        a.push(new THREE.Vector3(i,n,0));\r\n        a.push(new THREE.Vector3(0,n,0));\r\n        a.push(new THREE.Vector3(0,n,s));\r\n        let o = (new THREE.BufferGeometry()).setFromPoints(a)\r\n          , c = new THREE.Line(r,e);\r\n        this.scene.add(c);\r\n        let l = new THREE.Line(o,e);\r\n        this.scene.add(l)\r\n    }\r\n    writeNumber() {\r\n        let e = this\r\n        let t = this.config.size.tilesize;\r\n        let i = (i, n, s, a) => {\r\n            let r = function(e) {\r\n                let i = document.createElement(\"canvas\")\r\n                  , n = i.getContext(\"2d\");\r\n                i.width = i.height = 2 * t;\r\n                n.font = \"Bold \" + 2 * t + \"px Roboto\";\r\n                n.fillStyle = \"#7F007F\";\r\n                n.textAlign = \"center\";\r\n                n.fillText(e, t, 1.74591293182 * t);\r\n                let s = new THREE.Texture(i);\r\n                s.needsUpdate = !0;\r\n                let a = new THREE.SpriteMaterial({\r\n                    map: s\r\n                })\r\n                  , r = new THREE.Sprite(a);\r\n                r.scale.set(i.width, i.width, i.width);\r\n                return r;\r\n            }(String(i));\r\n            r.position.set((n - .5) * t, (s - .5) * t, (a - .5) * t);\r\n            e.scene.add(r);\r\n        }\r\n        let n = this.config[\"axis-labels\"];\r\n        n[\"axis-x\"].show && n[\"axis-x\"].list.forEach((e) => i(e, e, 0, 0));\r\n        n[\"axis-y\"].show && n[\"axis-y\"].list.forEach((e) => i(e, 0, e, 0));\r\n        n[\"axis-z\"].show && n[\"axis-z\"].list.forEach((e) => i(e, 0, 0, e));\r\n    }\r\n    makeFrame() {\r\n                    let t = {...this.limit, ...this.config.size};\r\n                    t = {...t,\r\n                        sx: t.idx * t.tilesize,\r\n                        sy: t.idy * t.tilesize,\r\n                        sz: t.idz * t.tilesize\r\n                    };\r\n                    t = {...t,\r\n                        hsx: t.sx / 2,\r\n                        hsy: t.sy / 2,\r\n                        hsz: t.sz / 2\r\n                    };\r\n                    //console.info(\"make frame with size: \", t.idx, \"x\", t.idy, \"x\", t.idz);\r\n                    //this.controls.target.set(t.hsx, t.hsy, t.hsz);\r\n                    let i = [new THREE.Vector3(3 * Math.PI / 2,0,0), new THREE.Vector3(3 * Math.PI / 2,3 * Math.PI / 2,0), new THREE.Vector3(Math.PI,0,0)]\r\n                      , n = this.limit.ix0 * t.tilesize\r\n                      , s = this.limit.iy0 * t.tilesize\r\n                      , a = this.limit.iz0 * t.tilesize\r\n                      , r = [new THREE.Vector3(t.hsx + n,0 + s,t.hsz + a), new THREE.Vector3(t.hsx + n,t.sy + s,t.hsz + a), new THREE.Vector3(0 + n,t.hsy + s,t.hsz + a), new THREE.Vector3(t.sx + n,t.hsy + s,t.hsz + a), new THREE.Vector3(t.hsx + n,t.hsy + s,0 + a), new THREE.Vector3(t.hsx + n,t.hsy + s,t.sz + a)]\r\n                      , o = function(i, n, s, a) {\r\n                        let r = i[0]\r\n                          , o = i[1]\r\n                          , c = new THREE.PlaneGeometry(t[\"s\" + r],t[\"s\" + o],t[\"id\" + r],t[\"id\" + o])\r\n                          , l = new THREE.MeshBasicMaterial({\r\n                            vertexColors: THREE.FaceColors,\r\n                            side: a\r\n                        });\r\n                        let h = new THREE.Mesh(c,l);\r\n                        h.position.copy(s);\r\n                        h.rotation.setFromVector3(n);\r\n                        return h;\r\n                    }\r\n                    let l = new THREE.Object3D();\r\n                    l.add(o(\"xzy\", i[0], r[0], THREE.BackSide));\r\n                    l.add(o(\"xzy\", i[0], r[1], THREE.FrontSide));\r\n                    l.add(o(\"yzx\", i[1], r[2], THREE.FrontSide));\r\n                    l.add(o(\"yzx\", i[1], r[3], THREE.BackSide));\r\n                    l.add(o(\"xyz\", i[2], r[4], THREE.FrontSide));\r\n                    l.add(o(\"xyz\", i[2], r[5], THREE.BackSide));\r\n                    this.scene.remove(this.cubeFrame);\r\n                    this.cubeFrame = l;\r\n                    this.scene.add(l);\r\n                    return l;\r\n    }\r\n    updateChart(data) {\r\n        this.data = data;\r\n        //console.log(\"updateChart\");\r\n        this.updateFaceAB(true);\r\n        this.updateFaceAB(false);\r\n        this.updateFaceCD(true);\r\n        this.updateFaceCD(false);\r\n        this.updateFaceEF(true);\r\n        this.updateFaceEF(false);\r\n    }\r\n}\r\n\r\nexport default perfectChart;"]},"metadata":{},"sourceType":"module"}